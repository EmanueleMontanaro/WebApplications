# `movie-server`

## APIs
Hereafter, we report the designed HTTP APIs, also implemented in the project.

### __List all movies__

URL: `/api/library/movies`

HTTP Method: GET.

Description: Retrieve all movies.

Request body: __None__

Response: `200 OK` (success) or `500 Internal Server Error` (generic error).

Response body:
```
[
  {
    "id": 1,
    "title": "Pulp Fiction",
    "userid": 1,
    "favorites": 1,
    "date": "2024-03-10",
    "rating": 5
  },
  ...
]
```

### __Get all favorite movies__

URL `/api/library/movies?filter=favorites`

HTTP Method: GET.

Description: Retrieve all movies with isFavorite set to 1.

Request body: __None__

Response: `200 OK` (success) or `500 Internal Server Error` (generic error).

Response body:
```
[
  {
    "id": 1,
    "title": "Pulp Fiction",
    "userid": 1,
    "favorites": 1,
    "date": "2024-03-10",
    "rating": 5
  },
  ...
]
```

### __Get all max rated movies__

URL: `/api/library/movies?filter=maxR`

HTTP Method: GET.

Description: Retrieve all movies where rating = 5.

Request body: __None__

Response: `200 OK` (success) or `500 Internal Server Error` (generic error).

Response body:
```
[
  {
    "id": 1,
    "title": "Pulp Fiction",
    "userid": 1,
    "favorites": 1,
    "date": "2024-03-10",
    "rating": 5
  },
  ...
]
```

### __Get all unseen movies__

URL: `/api/library/movies?filter=unseen`

HTTP Method: GET.

Description: Retrieve all movies where watchDate is null.

Request body: __None__

Response: `200 OK` (success) or `500 Internal Server Error` (generic error).

Response body:
```
[
  {
    "id": 3,
    "title": "Star Wars",
    "userid": 1,
    "favorites": 0,
    "date": NULL,
    "rating": NULL
  },
  ...
]
```

### __Get all movies watched last month__

URL: `/api/library/movies?filter=lastMonth`

HTTP Method: GET.

Description: Retrieve all movies where watchDate is within last 30 days.

Request body: __None__

Response: `200 OK` (success) or `500 Internal Server Error` (generic error).

Response body:
```
[
  {
    "id": 1,
    "title": "Shrek",
    "userid": 2,
    "favorites": 0,
    "date": "2024-03-21",
    "rating": 3
  },
  ...
]
```


### __Get a single__

URL: `/api/library/movies/<id>`

HTTP Method: GET.

Description: Retrieve the movie represented by `<id>`.

Request body: __None__

Response: `200 OK` (success), `404 Not Found` (wrong id), or `500 Internal Server Error` (generic error).

Response body:
```
{
  "id": 1,
  "title": "Pulp Fiction",
  "userid": 1,
  "favorites": 1,
  "date": "2024-03-10",
  "rating": 5
}
```

### __Create a new movie__

URL: `/api/library/movies`

HTTP Method: POST.

Description: Create a new movie given all informations needed (title, isFavorite, rating, watchDate and userId) while ID is automatically generated by the back-end.

Request body:
```
{
  "title": "Avatar",
  "favorites": 0,
  "rating": 5,
  "date": "2024-04-01",
  "userid": 1
}
```

Response: `201 Created` (success), if data passed isn't correct `422 Unprocessable Entity` (validation error), or `503 Service Unavailable` (generic error).

Response body: __None__

### __Update all infos of a movie__

URL: `/api/library/movies/<id>`

HTTP Method: PUT.

Description: Update all data for a specific movie identified by `<id>`.

Request body:
```
{
  "id": 3,
  "title": "Avatar",
  "favorites": 0,
  "rating": 5,
  "date": "2024-04-01",
  "userid": 1
}
```

Response: `200 OK` (success), `404 Not Found` (wrong id), or `503 Service Unavailable` (generic error). If the request body is not valid, `422 Unprocessable Entity` (validation error).

Response body: __None__

### __Update rating of a movie__

URL: `/api/library/movies/<id>`

HTTP Method: PUT.

Description: Update the rating for a specific movie identified by `<id>`.

Request body:
```
{
  "id": 3,
  "rating": 5
}
```

Response: `200 OK` (success), `404 Not Found` (wrong id), or `503 Service Unavailable` (generic error). If the request body is not valid, `422 Unprocessable Entity` (validation error).

Response body: __None__

### __Update isFavorite of a movie__

URL: `/api/library/movies/<id>`

HTTP Method: PUT.

Description: Update isFavorite property for a specific movie identified by `<id>`.

Request body:
```
{
  "id": 3,
  "favorite": 1
}
```

Response: `200 OK` (success), `404 Not Found` (wrong id), or `503 Service Unavailable` (generic error). If the request body is not valid, `422 Unprocessable Entity` (validation error).

Response body: __None__

### __Delete movie__

URL: `/api/library/movies/<id>`

HTTP Method: DELETE.

Description: Delete a specific movie identified by `<id>`.

Request body: __None__

Response: `200 OK` (success), `404 Not Found` (wrong id), or `503 Service Unavailable` (generic error).

Response body: __None__